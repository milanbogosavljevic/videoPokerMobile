this.system=this.system||{},function(){"use strict";const a=function(a,b,c){this.Container_constructor(),this._init(a,b,c)},b=createjs.extend(a,createjs.Container);b._image=null,b._hold=null,b._holdMarker=null,b.number=null,b.symbol=null,b._init=function(a,b,c){this._image=a,this._image.regX=a.sourceRect.width/2,this._image.regY=a.sourceRect.height/2,this._image.y=80,this._holdMarker=system.CustomMethods.makeImage("holdMarker",!1,!0),this._holdMarker.y=76,this._holdMarker.visible=!1,this._hold=!1,this.addChild(this._image,this._text,this._holdMarker),this.number=b,this.symbol=c,this.on("click",()=>{this.toggleHold()})},b.toggleHold=function(){system.SoundManager.play("selectCardSound"),this._hold=!this._hold,this._holdMarker.visible=this._hold},b.isForchange=function(){return!this._hold},b.updateCard=function(a,b){this.number=a.number,this.symbol=a.symbol;const c=this.number+this.symbol,d=b.animations[c],e=b.frames[d];createjs.Tween.get(this._image).to({skewY:10,scaleX:0},200,createjs.Ease.getPowInOut(2)).call(()=>{this._image.sourceRect=new createjs.Rectangle(e[0],e[1],e[2],e[3]),createjs.Tween.get(this._image).to({skewY:0,scaleX:1},200,createjs.Ease.getPowInOut(2))})},b.unholdCard=function(){this._hold=this._holdMarker.visible=!1},system.Card=createjs.promote(a,"Container")}();this.system=this.system||{},function(){"use strict";const a=function(){this.init()},b=a.prototype;b._server=null,b.init=function(){this._server=new system.Server},b.getFirstDrawCards=function(){return this._server.dealFirstDrawCards()},b.changeCards=function(a){return this._server.getChangedCards(a)},b.getStartingInfo=function(){return this._server.getStartingInfo()},b.updateBet=function(a){this._server.setBet(a)},b.collectWin=function(){return this._server.collectWin()},b.onGamble=function(a){return this._server.onGamble(a)},b.logCards=function(){this._server.logCards()},system.Communicator=a}();this.system=this.system||{},function(){"use strict";const a=function(a,b,c){this.Container_constructor(),this._init(a,b,c)},b=createjs.extend(a,createjs.Container);b._game=null,b._drawChangeCollectButton=null,b._betButton=null,b._betLevels=null,b._currentBetIndex=null,b._betMarker=null,b._balanceText=null,b._winText=null,b._init=function(a,b,c){this._game=a,this._betLevels=b,this._currentBetIndex=0;const d=system.CustomMethods.makeImage("controlboardBackground",!1);this.addChild(d),this._setButtons(),this._setTextFields(),this.updateBalance(c)},b._setTextFields=function(){const a=system.CustomMethods.makeText("BET","15px Russo","#f8fffd","center","middle");a.x=180,a.y=15,system.CustomMethods.cacheText(a);const b=this._betMarker=system.CustomMethods.makeImage("betMarker",!1,!0);b.x=122,b.y=50,this.addChild(b);for(let a,b=0;b<this._betLevels.length;b++)a=system.CustomMethods.makeText(this._betLevels[b],"12px Russo","#5b8bff","center","middle"),a.x=122+29*b,a.y=51,system.CustomMethods.cacheText(a),this.addChild(a);const c=system.CustomMethods.makeText("WIN","15px Russo","#f8fffd","center","middle");c.x=480,c.y=15,system.CustomMethods.cacheText(c);let d=this._winText=system.CustomMethods.makeText("0.00","18px Russo","#ec5750","center","middle");d.x=c.x,d.y=51,system.CustomMethods.cacheText(this._winText);const e=system.CustomMethods.makeText("BALANCE","15px Russo","#f8fffd","center","middle");e.x=780,e.y=15,system.CustomMethods.cacheText(e);let f=this._balanceText=system.CustomMethods.makeText("0","18px Russo","#ec5750","center","middle");f.x=e.x,f.y=51,system.CustomMethods.cacheText(this._balanceText),this.addChild(a,c,d,e,f)},b._setButtons=function(){let a=system.CustomMethods.makeImage("button",!0);const b=this._betButton=new system.Button(a);b.x=64,b.y=-25;const c=system.CustomMethods.makeText("BET","15px Russo","#3f3f3f","center","middle");system.CustomMethods.cacheText(c),b.addText(c),b.centerText(),b.on("click",()=>{b.doScaleAnimation(),this.onBet()}),this.addChild(b);let d=system.CustomMethods.makeImage("button",!0);const e=this._drawChangeCollectButton=new system.Button(d);e.x=896,e.y=-25,e.on("click",()=>{e.doScaleAnimation(),this.onDrawChangeCollect()});const f=system.CustomMethods.makeText("DRAW","15px Russo","#3f3f3f","center","middle");e.addText(f),e.centerText(),this.addChild(e)},b._updateBet=function(){this._currentBetIndex++;let a=this._betLevels.length-1;this._currentBetIndex>a&&(this._currentBetIndex=0)},b._moveBetMarker=function(){this._betMarker.x=122+29*this._currentBetIndex},b.onBet=function(){system.SoundManager.play("betSound",.2),this._updateBet(),this._moveBetMarker(),this._game.betChanged(this.getCurrentBet())},b.onDrawChangeCollect=function(){system.SoundManager.play("drawChangeCollectButtonSound"),this._game.onDrawChangeCollect(),this.updateDrawChangeCollectButtonText()},b.animateCollect=function(){let a=+this._winText.text,b=+this._balanceText.text,c=+(a/10).toFixed(2),d=setInterval(()=>{if(a-=c,a=+a.toFixed(2),b+=c,b=+b.toFixed(2),0<a)this.updateWin(a),this.updateBalance(b);else{clearInterval(d),d=null;const a=new createjs.Event("collectingDone",!0,!0);this.dispatchEvent(a)}},100)},b.updateDrawChangeCollectButtonText=function(){let a=this._game.getState().toUpperCase();this._drawChangeCollectButton.updateText(a)},b.enableBetButton=function(a){this._betButton.enableClick(a),this._betButton.alpha=!0===a?1:.6},b.enableDrawChangeCollectButton=function(a){this._drawChangeCollectButton.enableClick(a),this._drawChangeCollectButton.alpha=!0===a?1:.6},b.getCurrentBet=function(){return this._betLevels[this._currentBetIndex]},b.updateWin=function(a){this._winText.uncache(),this._winText.text=a,system.CustomMethods.cacheText(this._winText)},b.updateBalance=function(a){this._balanceText.uncache(),this._balanceText.text=a,system.CustomMethods.cacheText(this._balanceText)},b.drawChangeCollectButtonIsEnabled=function(){return this._drawChangeCollectButton.isEnabled()},b.betButtonIsEnabled=function(){return this._betButton.isEnabled()},system.ControlboardComponent=createjs.promote(a,"Container")}();this.system=this.system||{},function(){"use strict";const a=function(a,b){this.Container_constructor(),this.init(a,b)},b=createjs.extend(a,createjs.Container);b._game=null,b._leftCard=null,b._rightCard=null,b._rightCardOverlay=null,b._buttonHigh=null,b._buttonLow=null,b._overlay=null,b._previousCards=null,b._atlas=null,b._json=null,b._animationInterval=null,b._pauseInterval=null,b._buttonsOverlay=null,b._isEnabled=null,b.init=function(a,b){this._atlas=system.CustomMethods.makeImage("cardsAtlas",!0),this._json=queue.getResult("cardsJson"),this._game=a,this._previousCards=[],this._pauseInterval=!1,this._isEnabled=!1;const c=system.CustomMethods.makeImage("gambleBackground",!1);this.addChild(c),this._setButtons(),this._setCards(b),this._enableButtons(!1);const d=this._overlay=system.CustomMethods.makeImage("gambleOverlay",!1);this.addChild(d)},b._setCards=function(a){const b=a.number+a.symbol,c=this._leftCard=system.CustomMethods.makeImageFromAtlas(this._atlas,this._json,b,!1);c.regX=c.sourceRect.width/2,c.regY=c.sourceRect.height/2,c.x=70,c.y=93,this.addChild(c);const d=this._rightCard=system.CustomMethods.makeImageFromAtlas(this._atlas,this._json,"5diamonds",!1);d.regX=d.sourceRect.width/2,d.regY=d.sourceRect.height/2,d.x=d.startX=306,d.y=c.y,d.visible=!1;const e=this._rightCardOverlay=system.CustomMethods.makeImage("gambleCard",!1,!0);e.x=d.x,e.y=d.y,this.addChild(e),this.addChild(d);for(let b,c=0;c<8;c++)b=system.CustomMethods.makeImageFromAtlas(this._atlas,this._json,"14diamonds",!1),b.scale=.3,b.x=21+c*43,b.y=178,this._previousCards.push(b),this.addChild(b)},b._setButtons=function(){let a=system.CustomMethods.makeImage("highButton",!0);const b=this._buttonHigh=new system.Button(a);b.x=188,b.y=45,b.on("click",()=>{b.doScaleAnimation(),this.onButton("High")}),this.addChild(b),a=system.CustomMethods.makeImage("lowButton",!0);const c=this._buttonLow=new system.Button(a);c.x=b.x,c.y=140,c.on("click",()=>{c.doScaleAnimation(),this.onButton("Low")}),this.addChild(c);const d=this._buttonsOverlay=system.CustomMethods.makeImage("gambleButtonsOverlay",!1,!0);d.x=b.x,d.y=b.y,this.addChild(d)},b.onButton=function(a){this._game.onGambleButton(a);this._pauseInterval=!0,this._buttonsOverlay.y=this["_button"+a].y},b._enableButtons=function(a){this._isEnabled=a,this._buttonHigh.enableClick(a),this._buttonLow.enableClick(a)},b.isEnabled=function(){return this._isEnabled},b.revealCard=function(a,b,c){system.SoundManager.pause("gambleTensionSound",!0),this._enableButtons(!1);const d=a.number+a.symbol,e=this._json.animations[d],f=this._json.frames[e];createjs.Tween.get(this._rightCardOverlay).to({skewY:10,scaleX:0},200,createjs.Ease.getPowInOut(2)).call(()=>{this._rightCardOverlay.visible=!1,this._rightCard.sourceRect=new createjs.Rectangle(f[0],f[1],f[2],f[3]),this._rightCard.skewY=10,this._rightCard.scaleX=0,this._rightCard.visible=!0,createjs.Tween.get(this._rightCard).to({skewY:0,scaleX:1},200,createjs.Ease.getPowInOut(2)).call(()=>{this._rightCardOverlay.skewY=0,this._rightCardOverlay.scaleX=1,this._rightCardOverlay.visible=!0;let a="0.00"===c?"gambleLoseSound":"gambleWinSound";system.SoundManager.play(a);const d=Math.round(system.SoundManager.getDuration(a));createjs.Tween.get(this._rightCard).wait(d).to({x:this._leftCard.x},500).call(()=>{this._leftCard.sourceRect=this._rightCard.sourceRect,this._rightCard.x=this._rightCard.startX,this._rightCard.visible=!1,this._updatePreviousCards(b),"0.00"===c?this._game.gambleLost():this._enableButtons(!0),this._pauseInterval=!1,system.SoundManager.pause("gambleTensionSound",!1)})})})},b._updatePreviousCards=function(a){const b=a;for(let c=0;c<b.length;c++){const a=b[c].number+b[c].symbol,d=this._json.animations[a],e=this._json.frames[d];this._previousCards[c].sourceRect=new createjs.Rectangle(e[0],e[1],e[2],e[3])}},b._activateAnimation=function(a){!0===a?this._animationInterval=setInterval(()=>{!1===this._pauseInterval&&(this._buttonsOverlay.y=this._buttonsOverlay.y===this._buttonHigh.y?this._buttonLow.y:this._buttonHigh.y)},300):(clearInterval(this._animationInterval),this._animationInterval=null)},b.activateGamble=function(a){this._overlay.visible=!a,this._activateAnimation(a),this._enableButtons(a),!0===a?system.SoundManager.play("gambleTensionSound",.5,-1):system.SoundManager.stop("gambleTensionSound")},system.GambleComponent=createjs.promote(a,"Container")}();this.system=this.system||{},function(){"use strict";const a=function(){this.Container_constructor(),this._init()},b=createjs.extend(a,createjs.Container);b._message=null,b._init=function(){const a=system.CustomMethods.makeImage("messagesBackground",!1);this.addChild(a),this.regX=a.image.width/2,this.regY=a.image.height/2,this._message=system.CustomMethods.makeText("message","22px Russo","#ec5750","center","middle"),this._message.x=this.regX,this._message.y=this.regY,this.addChild(this._message),system.CustomMethods.cacheText(this._message)},b.updateMessage=function(a){this._message.uncache(),this._message.text=a,system.CustomMethods.cacheText(this._message)},system.MessagesComponent=createjs.promote(a,"Container")}();this.system=this.system||{},function(){"use strict";const a=function(a){this.Container_constructor(),this.init(a)},b=createjs.extend(a,createjs.Container);b._winFields=null,b._winMarker=null,b._bonusWin=null,b.init=function(a){this._winFields=[];const b=system.CustomMethods.makeImage("paytableBackground",!1);this.addChild(b),this._winMarker=system.CustomMethods.makeImage("paytableMarker",!1),this._winMarker.x=9,this._winMarker.visible=!1,this.addChild(this._winMarker);for(let b=0;b<a.length;b++){const c=a[b].winType,d=a[b].multiplier,e=this.getStringForPaytableItem(c),f=new system.PaytableWin(c,d,e);f.x=15,f.y=12+b*22,this._winFields.push(f),this.addChild(f)}const c=system.CustomMethods.makeText("BONUS WIN","18px Russo","#dcf799","left","hanging");c.x=68,c.y=214,system.CustomMethods.cacheText(c),this.addChild(c);const d=this._bonusWin=system.CustomMethods.makeText("0.00","17px Russo","#dcf799","center","middle");d.x=280,d.y=222,system.CustomMethods.cacheText(d),this.addChild(d)},b.getStringForPaytableItem=function(a){let b;return"pair"===a?b="PAIR":"twoPairs"===a?b="TWO PAIRS":"threeOfKind"===a?b="THREE OF KIND":"straight"===a?b="STRAIGHT":"flush"===a?b="FLUSH":"full"===a?b="FULL HOUSE":"poker"===a?b="POKER":"straightFlush"===a?b="STRAIGHT FLUSH":"royalFlush"===a?b="ROYAL FLUSH":void 0,b},b.updateForBet=function(a){this._winFields.forEach(b=>{b.updateWinValue(a)})},b.updateForWin=function(a){if("noWin"===a)this._winMarker.visible=!1;else{let b=this._winFields.find(b=>b.winType===a);this._winMarker.y=b.y-5,this._winMarker.visible=!0}},b.updateBonusWin=function(a){this._bonusWin.uncache(),this._bonusWin.text=a,system.CustomMethods.cacheText(this._bonusWin)},system.PaytableComponent=createjs.promote(a,"Container")}();this.system=this.system||{},function(){"use strict";const a=function(a,b,c){this.Container_constructor(),this.init(a,b,c)},b=createjs.extend(a,createjs.Container);b.winType=null,b._winTypeText=null,b._winValueText=null,b._winMultiplier=null,b.init=function(a,b,c){this.winType=a,this._winMultiplier=b,this._winTypeText=system.CustomMethods.makeText(c,"15px Russo","#56ea4c","left","hanging"),system.CustomMethods.cacheText(this._winTypeText),this._winValueText=system.CustomMethods.makeText("0.00","15px Russo","#56ea4c","right","hanging"),this._winValueText.x=344,system.CustomMethods.cacheText(this._winValueText),this.addChild(this._winTypeText,this._winValueText)},b.updateWinValue=function(a){this._winValueText.uncache(),this._winValueText.text=(a*this._winMultiplier).toFixed(2),system.CustomMethods.cacheText(this._winValueText)},system.PaytableWin=createjs.promote(a,"Container")}();this.system=this.system||{},function(){"use strict";const a=function(a){this.Container_constructor(),this.init(a)},b=createjs.extend(a,createjs.Container);b._cardsInHand=null,b._cardsTochange=null,b._cardsAtlas=null,b._cardsJson=null,b.init=function(a){this._cardsInHand=[],this._cardsTochange=[],this._cardsAtlas=system.CustomMethods.makeImage("cardsAtlas",!0),this._cardsJson=queue.getResult("cardsJson"),this._makeCardObjects(a)},b._makeCardObjects=function(a){for(let b=0;b<a.length;b++){let c=a[b].number,d=a[b].symbol,e=system.CustomMethods.makeImageFromAtlas(this._cardsAtlas,this._cardsJson,c+d,!0),f=new system.Card(e,c,d);f.x=150*b,this._cardsInHand.push(f),this.addChild(f)}},b.setStartCards=function(a){for(let b=0;b<a.length;b++)this._cardsInHand[b].updateCard(a[b],this._cardsJson)},b.getCardsToChange=function(){for(let a=0;a<this._cardsInHand.length;a++)this._cardsInHand[a].isForchange()&&this._cardsTochange.push(this._cardsInHand[a]);return this._cardsTochange},b.updateCards=function(a){for(let b=0;b<a.length;b++)this._cardsTochange[b].updateCard(a[b],this._cardsJson);this._unholdCards()},b._unholdCards=function(){for(let a=0;a<this._cardsInHand.length;a++)this._cardsInHand[a].unholdCard()},b.resetCards=function(){this._cardsTochange=[];const a={number:"card",symbol:"Back"};for(let b=0;b<this._cardsInHand.length;b++)this._cardsInHand[b].updateCard(a,this._cardsJson)},b.selectCardByKeyboard=function(a){this._cardsInHand[a].toggleHold()},b.enableCardsClick=function(a){this.mouseEnabled=a},b.isEnabled=function(){return this.mouseEnabled},system.PlayerCardsComponent=createjs.promote(a,"Container")}();this.system=this.system||{},function(){"use strict";const a=function(){this.init()},b=a.prototype;b._cards=null,b._gambleCards=null,b._gambleCardsPassed=null,b._playerCards=null,b._baseWin=null,b._bonusWin=null,b._totalWin=null,b._winType=null,b._isStraight=!1,b._paytableInfo=null,b._balance=null,b._betLevels=null,b._currentBet=null,b.init=function(){this._cards=[],this._gambleCards=[],this._gambleCardsPassed=[],this._betLevels=[1,5,20,50,100],this._balance=100,this._currentBet=this._betLevels[0],this._winType="noWin",this._baseWin=0,this._bonusWin=0,this._totalWin=0,this._paytableInfo=[{winType:"royalFlush",multiplier:250},{winType:"straightFlush",multiplier:50},{winType:"poker",multiplier:25},{winType:"full",multiplier:8},{winType:"flush",multiplier:5},{winType:"straight",multiplier:4},{winType:"threeOfKind",multiplier:3},{winType:"twoPairs",multiplier:2},{winType:"pair",multiplier:1}];const a=["hearts","diamonds","spades","clubs"];for(let b=0;4>b;b++)for(let c=2;15>c;c++){const d={symbol:a[b],number:c};this._cards.push(d),this._gambleCards.push(d)}},b.dealFirstDrawCards=function(){if(this._playerCards=[],this._balance<this._currentBet)return{message:"Not enough money to play"};this._balance-=this._currentBet;for(let a=0;5>a;a++){const a=this._cards.length-1;let b=system.CustomMethods.getRandomNumberFromTo(1,a);const c=this._cards[b];this._playerCards.push(c),this._cards.splice(b,1)}this._checkForWinType(),this._setWin();const a=this._playerCards.slice(0),b=this._winType,c=this._balance.toFixed(2),d=this._bonusWin.toFixed(2),e=this._totalWin.toFixed(2);return{cards:a,winType:b,balance:c,bonusWin:d,totalWin:e}},b._checkForWinType=function(){this._winType="noWin",this._checkSameNumbersWin(),"noWin"===this._winType&&(this._checkForStraight(),this._checkForFlush())},b._checkForFlush=function(){let a,b=this._playerCards,c=b.length,d=b[0].symbol;for(a=1;a<c&&!(d!==b[a].symbol);a++);const e=a===c;!0==e&&("straight"===this._winType?14===this._playerCards[4].number?this._winType="royalFlush":this._winType="straightFlush":this._winType="flush")},b._checkForStraight=function(){let a=this._playerCards.slice(0);a.sort(function(c,a){return c.number-a.number});let b,c=a.length-1;for(b=0;b<c;b++){let c=b+1,d=a[c].number,e=a[b].number;if(e!==d-1)break}this._winType=b===c?"straight":"noWin"},b._checkSameNumbersWin=function(){let a=[],b=this._playerCards.slice(0);for(let c,d=b.length-1;-1<d;d--){c=b[d],b.splice(d,1);let e=[];for(let a,f=b.length-1;-1<f;f--)a=b[f],c.number===a.number&&(0===e.length&&e.push(c),e.push(a),b.splice(f,1),d--);0<e.length&&a.push(e)}if(1===a.length)switch(a[0].length){case 2:this._winType="pair";break;case 3:this._winType="threeOfKind";break;case 4:this._winType="poker";}else 2===a.length&&(this._winType=a[0].length===a[1].length?"twoPairs":"full")},b._setWin=function(){if(this._baseWin=0,this._bonusWin=0,"noWin"!==this._winType){let a=this._paytableInfo.find(a=>a.winType===this._winType);this._baseWin=this._currentBet*a.multiplier,this._playerCards.forEach(a=>{this._bonusWin+=a.number}),this._bonusWin=this._bonusWin/100*this._currentBet}this._totalWin=this._baseWin+this._bonusWin},b.getChangedCards=function(a){const b=a.length;let c=this._playerCards,d=[];for(let b=0;b<a.length;b++){const d=a[b];for(let a=c.length-1;-1<a;a--)d.symbol===c[a].symbol&&d.number===c[a].number&&c.splice(a,1)}for(let e=0;e<b;e++){const a=this._cards.length-1,b=system.CustomMethods.getRandomNumberFromTo(0,a),e=this._cards[b];c.push(e),d.push(e),this._cards.splice(b,1)}this._checkForWinType(),this._setWin(),this._cards=this._cards.concat(a),this._cards=this._cards.concat(c);const e=this._winType,f=this._bonusWin.toFixed(2),g=this._totalWin.toFixed(2);return{cards:d,winType:e,bonusWin:f,totalWin:g}},b.setBet=function(a){this._currentBet=a},b.collectWin=function(){this._balance+=this._totalWin;const a=this._balance.toFixed(2);return{balance:a}},b.getGambleCard=function(){const a=this._gambleCards.length-1;let b=system.CustomMethods.getRandomNumberFromTo(1,a);const c=this._gambleCards[b];if(this._gambleCardsPassed.unshift(c),this._gambleCards.splice(b,1),20<this._gambleCardsPassed.length){const a=this._gambleCardsPassed.splice(8,20);this._gambleCards=this._gambleCards.concat(a)}return c},b.onGamble=function(a){const b=this._gambleCardsPassed[0],c=this.getGambleCard();return this["_checkFor"+a](b,c),{card:c,totalWin:this._totalWin.toFixed(2),previousCards:this._gambleCardsPassed.slice(0,8)}},b._checkForHigh=function(a,b){b.number>a.number?this._totalWin*=2:this._totalWin=0},b._checkForLow=function(a,b){b.number<a.number?this._totalWin*=2:this._totalWin=0},b.getStartingInfo=function(){return{betLevels:this._betLevels,balance:this._balance.toFixed(2),paytableInfo:this._paytableInfo,gambleCard:this.getGambleCard()}},b.logCards=function(){this._gambleCards&&console.log(this._gambleCards.length)},system.Server=a}();this.system=this.system||{},function(){"use strict";const a=function(a){this.Container_constructor(),this._init(a)},b=createjs.extend(a,createjs.Container);b._game=null,b._background=null,b._soundButton=null,b._infoButton=null,b._init=function(a){this._game=a;const b=this._background=system.CustomMethods.makeImage("soundInfoBackground",!1);this.addChild(b);const c=system.CustomMethods.makeImage("soundButton",!0),d=this._soundButton=new system.Button(c);d.x=26,d.y=24,d.on("click",()=>{this._game.onSoundButton(),d.alpha=!0===createjs.Sound.muted?.6:1}),this.addChild(d);const e=system.CustomMethods.makeImage("infoButton",!0),f=this._infoButton=new system.Button(e);f.x=88,f.y=25,f.on("click",()=>{this._game.onInfoButton()}),this.addChild(f);const g=system.CustomMethods.makeImage("showSoundInfoComponentButton",!0),h=new system.Button(g);h.x=b.image.width/2,h.y=64,h.on("click",()=>{this._game.showHideSoundInfoComponent()}),this.addChild(h)},b.show=function(a){this._background.visible=this._soundButton.visible=this._infoButton.visible=a},system.SoundInfoComponent=createjs.promote(a,"Container")}();this.system=this.system||{},function(){"use strict";const a=function(){this.Container_constructor(),this._init()},b=createjs.extend(a,createjs.Container);b._paytableComponent=null,b._controlboardComponent=null,b._playerCardsComponent=null,b._gambleComponent=null,b._communicator=null,b._state=null,b._keyboardEnabled=null,b._infoPanel=null,b._soundInfoComponent=null,b._logo=null,b._messagesComponent=null,b._init=function(){this._registerSounds();const a=system.CustomMethods.makeImage("background",!0);this.addChild(a);const b=this._logo=system.CustomMethods.makeImage("logo",!1);b.regX=b.image.width/2,b.x=479,b.y=93,this.addChild(b),this._communicator=new system.Communicator,this._state="draw";const c=this._playerCardsComponent=new system.PlayerCardsComponent([{number:"10",symbol:"hearts"},{number:"11",symbol:"hearts"},{number:"12",symbol:"hearts"},{number:"13",symbol:"hearts"},{number:"14",symbol:"hearts"}]);c.x=180,c.y=285,c.enableCardsClick(!1);const d=this._communicator.getStartingInfo(),e=this._controlboardComponent=new system.ControlboardComponent(this,d.betLevels,d.balance);e.y=465,this.addChild(e);const f=this._paytableComponent=new system.PaytableComponent(d.paytableInfo);f.x=29,f.y=29,f.updateForBet(1),this.addChild(f);const g=this._gambleComponent=new system.GambleComponent(this,d.gambleCard);g.x=555,g.y=29,this.addChild(g),this.addChild(c);const h=this._messagesComponent=new system.MessagesComponent;h.x=480,h.y=270,h.scale=0,this.addChild(h),this._infoPanel=system.CustomMethods.makeImage("infoPanel",!1),this._infoPanel.visible=!1,this.addChild(this._infoPanel);const i=this._soundInfoComponent=new system.SoundInfoComponent(this);i.x=422,i.y=-49,this.addChild(i),document.onkeydown=a=>{this._handleKeydown(a.key)},this._enableKeyboard(!0)},b._registerSounds=function(){system.SoundManager.registerSound("betSound"),system.SoundManager.registerSound("collectSound"),system.SoundManager.registerSound("hasWinSound"),system.SoundManager.registerSound("gambleWinSound"),system.SoundManager.registerSound("gambleLoseSound"),system.SoundManager.registerSound("drawChangeCollectButtonSound"),system.SoundManager.registerSound("selectCardSound"),system.SoundManager.registerSound("gambleTensionSound"),system.SoundManager.registerSound("collectDone")},b._enableKeyboard=function(a){this._keyboardEnabled=a},b._handleKeydown=function(a){!0===this._keyboardEnabled&&("Enter"===a?this._drawChangeCollectByKeyboard():"+"===a?this._gambleByKeyboard("High"):"-"===a?this._gambleByKeyboard("Low"):"ArrowUp"===a?this._betByKeyboard():"1"===a?this._selectCardByKeyboard(0):"2"===a?this._selectCardByKeyboard(1):"3"===a?this._selectCardByKeyboard(2):"4"===a?this._selectCardByKeyboard(3):"5"===a?this._selectCardByKeyboard(4):void 0)},b._betByKeyboard=function(){!0===this._controlboardComponent.betButtonIsEnabled()&&this._controlboardComponent.onBet()},b._drawChangeCollectByKeyboard=function(){!0===this._controlboardComponent.drawChangeCollectButtonIsEnabled()&&this._controlboardComponent.onDrawChangeCollect()},b._gambleByKeyboard=function(a){!0===this._gambleComponent.isEnabled()&&this._gambleComponent.onButton(a)},b._selectCardByKeyboard=function(a){!0===this._playerCardsComponent.isEnabled()&&this._playerCardsComponent.selectCardByKeyboard(a)},b._draw=function(){this._controlboardComponent.enableBetButton(!1),this._controlboardComponent.enableDrawChangeCollectButton(!1),this._enableKeyboard(!1);const a=this._communicator.getFirstDrawCards();if(a.message)return void this._onGameOver(a.message);this._playerCardsComponent.resetCards(),this._state="change";const b=a.cards,c=a.winType,d=a.balance,e=a.bonusWin,f=a.totalWin;setTimeout(()=>{"noWin"!==c&&system.SoundManager.play("hasWinSound"),this._controlboardComponent.enableDrawChangeCollectButton(!0),this._controlboardComponent.updateBalance(d),this._controlboardComponent.updateWin(f),this._playerCardsComponent.enableCardsClick(!0),this._playerCardsComponent.setStartCards(b),this._paytableComponent.updateForWin(c),this._paytableComponent.updateBonusWin(e),this._enableKeyboard(!0)},500)},b._onGameOver=function(a){console.log("game over"),this._messagesComponent.updateMessage(a),createjs.Tween.get(this._messagesComponent).to({scale:1},500,createjs.Ease.cubicIn).wait(2e3).to({scale:0},500,createjs.Ease.cubicIn).call(()=>{this._controlboardComponent.enableBetButton(!0),this._controlboardComponent.enableDrawChangeCollectButton(!0),this._enableKeyboard(!0)})},b._change=function(){let a=this._playerCardsComponent.getCardsToChange(),b=[];a.forEach(a=>{b.push({number:a.number,symbol:a.symbol})});let c=this._communicator.changeCards(b);const d=c.cards,e=c.winType,f=c.bonusWin,g=c.totalWin;this._paytableComponent.updateForWin(e),this._paytableComponent.updateBonusWin(f),this._controlboardComponent.updateWin(g),this._playerCardsComponent.enableCardsClick(!1),this._playerCardsComponent.updateCards(d),"noWin"===e?(this._state="draw",this._controlboardComponent.enableBetButton(!0)):(this._state="collect",this._gambleComponent.activateGamble(!0))},b._collect=function(){system.SoundManager.play("collectSound",1,-1),this._state="draw",this._gambleComponent.activateGamble(!1);const a=this._communicator.collectWin(),b=a.balance;this._controlboardComponent.animateCollect();const c=this.on("collectingDone",a=>{system.SoundManager.stop("collectSound"),a.remove(),this.off("collectingDone",c),this._controlboardComponent.updateBalance(b),this._controlboardComponent.updateWin("0.00"),this._controlboardComponent.enableBetButton(!0),this._paytableComponent.updateForWin("noWin"),this._paytableComponent.updateBonusWin("0.00"),this._animateLogo()})},b._animateLogo=function(){createjs.Tween.get(this._logo).to({alpha:.4},100).to({alpha:1},100).to({alpha:.4},100).to({alpha:1},100).call(()=>{system.SoundManager.play("collectDone",.2)})},b.showHideSoundInfoComponent=function(){this._soundInfoComponent.show(!0);const a=0===this._soundInfoComponent.y?-49:0;createjs.Tween.get(this._soundInfoComponent).to({y:a},500,createjs.Ease.cubicIn).call(()=>{-49===this._soundInfoComponent.y&&this._soundInfoComponent.show(!1)})},b.onInfoButton=function(){system.SoundManager.play("drawChangeCollectButtonSound"),this._infoPanel.visible=!this._infoPanel.visible},b.onSoundButton=function(){system.SoundManager.play("drawChangeCollectButtonSound"),system.SoundManager.muteAllSounds()},b.onGambleButton=function(a){const b=this._communicator.onGamble(a),c="0.00"!==b.totalWin;this._controlboardComponent.enableDrawChangeCollectButton(c),this._controlboardComponent.updateWin(b.totalWin),this._gambleComponent.revealCard(b.card,b.previousCards,b.totalWin)},b.gambleLost=function(){this._state="draw",this._gambleComponent.activateGamble(!1),this._paytableComponent.updateForWin("noWin"),this._paytableComponent.updateBonusWin("0.00"),this._controlboardComponent.enableDrawChangeCollectButton(!0),this._controlboardComponent.enableBetButton(!0),this._controlboardComponent.updateDrawChangeCollectButtonText()},b.onDrawChangeCollect=function(){const a="_"+this._state;this[a]()},b.getState=function(){return this._state},b.betChanged=function(a){this._paytableComponent.updateForBet(a),this._communicator.updateBet(a)},b.render=function(a){stage.update(a)},system.VideoPokerGame=createjs.promote(a,"Container")}();